<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dokumen & Kebijakan â€” Sistem PDP PT Atri Pasifik</title>
    <link rel="stylesheet" href="style-pdp.css">
    <style>
        .doc-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 20px;
            transition: var(--transition);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .doc-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .doc-icon {
            font-size: 32px;
        }

        .doc-card h4 {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .doc-card p {
            font-size: 12px;
            color: var(--text-secondary);
            flex: 1;
        }

        .doc-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
    </style>
</head>

<body>
    <div class="app-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo"><img src="logo-atri.png" alt="AP"
                        onerror="this.style.display='none'; this.parentElement.innerHTML='<span style=\'font-size:16px;font-weight:800;color:#1B2B6B\'>AP</span>'">
                </div>
                <div class="sidebar-brand">
                    <h3>Sistem PDP</h3><span>PT Atri Pasifik</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section-title">Menu Utama</div>
                <a class="nav-item" href="dashboard.html"><span class="nav-icon">ğŸ“Š</span> Dashboard</a>
                <a class="nav-item" href="inventaris.html"><span class="nav-icon">ğŸ—‚ï¸</span> Inventaris Data</a>
                <a class="nav-item" href="consent.html"><span class="nav-icon">âœ…</span> Manajemen Consent</a>
                <a class="nav-item" href="dsr.html"><span class="nav-icon">ğŸ‘¤</span> Hak Subjek Data</a>
                <a class="nav-item" href="permintaan.html"><span class="nav-icon">ğŸ“</span> Permintaan Internal</a>
                <div class="nav-section-title">Kepatuhan</div>
                <a class="nav-item" href="dpia.html"><span class="nav-icon">âš ï¸</span> Penilaian Risiko (DPIA)</a>
                <a class="nav-item" href="insiden.html"><span class="nav-icon">ğŸš¨</span> Insiden & Pelanggaran</a>
                <div class="nav-section-title">Administrasi</div>
                <a class="nav-item active" href="dokumen.html"><span class="nav-icon">ğŸ“„</span> Dokumen & Kebijakan</a>
                <a class="nav-item" href="audit.html"><span class="nav-icon">ğŸ“‹</span> Audit Trail</a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar" id="sidebarUserAvatar">A</div>
                    <div class="user-meta">
                        <h4 id="sidebarUserName">Admin PDP</h4><span id="sidebarUserRole">DPO</span>
                    </div>
                    <button onclick="logout()"
                        style="margin-left:auto;background:none;border:none;color:rgba(255,255,255,0.5);cursor:pointer;font-size:18px;">ğŸšª</button>
                </div>
            </div>
        </aside>

        <div class="main-content">
            <header class="topbar">
                <div class="topbar-title">
                    <h2>Dokumen & Kebijakan</h2>
                    <p>Repositori kebijakan, SOP, dan template terkait Perlindungan Data Pribadi</p>
                </div>
                <div class="topbar-actions">
                    <button class="btn btn-primary" onclick="openModal('modalTambahDokumen')">+ Tambah Dokumen</button>
                </div>
            </header>

            <div class="page-content">
                <!-- Dokumen Wajib Banner -->
                <div class="card" style="margin-bottom:24px; background: linear-gradient(135deg, #EEF2FF, #E0F2FE);">
                    <div class="card-header" style="border:none; padding-bottom:0; margin-bottom:12px;">
                        <div class="card-title">ğŸ“Œ Dokumen Wajib UU PDP No. 27/2022</div>
                        <span class="badge badge-info">Referensi Regulasi</span>
                    </div>
                    <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:10px;">
                        <div
                            style="background:rgba(255,255,255,0.8); padding:12px; border-radius:10px; text-align:center;">
                            <div style="font-size:20px;">ğŸ“œ</div>
                            <div style="font-size:12px; font-weight:700; margin-top:6px; color:var(--primary);">
                                Kebijakan Privasi</div>
                            <div style="font-size:11px; color:var(--text-muted);">Pasal 20 & 21</div>
                        </div>
                        <div
                            style="background:rgba(255,255,255,0.8); padding:12px; border-radius:10px; text-align:center;">
                            <div style="font-size:20px;">ğŸ“‹</div>
                            <div style="font-size:12px; font-weight:700; margin-top:6px; color:var(--primary);">Prosedur
                                DSR</div>
                            <div style="font-size:11px; color:var(--text-muted);">Pasal 5â€“9</div>
                        </div>
                        <div
                            style="background:rgba(255,255,255,0.8); padding:12px; border-radius:10px; text-align:center;">
                            <div style="font-size:20px;">ğŸ¤</div>
                            <div style="font-size:12px; font-weight:700; margin-top:6px; color:var(--primary);">DPA
                                (Perjanjian Pihak Ketiga)</div>
                            <div style="font-size:11px; color:var(--text-muted);">Pasal 53â€“56</div>
                        </div>
                        <div
                            style="background:rgba(255,255,255,0.8); padding:12px; border-radius:10px; text-align:center;">
                            <div style="font-size:20px;">ğŸš¨</div>
                            <div style="font-size:12px; font-weight:700; margin-top:6px; color:var(--primary);">SOP
                                Insiden</div>
                            <div style="font-size:11px; color:var(--text-muted);">Pasal 46â€“47</div>
                        </div>
                    </div>
                </div>

                <!-- Tab Nav -->
                <div class="tab-nav">
                    <button class="tab-btn active" onclick="filterDokumen('', this)">ğŸ“ Semua</button>
                    <button class="tab-btn" onclick="filterDokumen('KEBIJAKAN', this)">ğŸ“œ Kebijakan</button>
                    <button class="tab-btn" onclick="filterDokumen('SOP', this)">ğŸ“‹ SOP</button>
                    <button class="tab-btn" onclick="filterDokumen('TEMPLATE', this)">ğŸ“ Template</button>
                    <button class="tab-btn" onclick="filterDokumen('PERJANJIAN', this)">ğŸ¤ Perjanjian</button>
                </div>

                <!-- Dokumen Grid -->
                <div id="docGrid" style="display:grid; grid-template-columns:repeat(3,1fr); gap:18px;"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: Tambah Dokumen -->
    <div class="modal-overlay" id="modalTambahDokumen">
        <div class="modal" style="max-width:560px;">
            <div class="modal-header">
                <div class="modal-icon info">ğŸ“„</div>
                <div>
                    <div class="modal-title">Tambah Dokumen Baru</div>
                    <div class="modal-subtitle">Upload ke repositori PDP</div>
                </div>
                <button class="modal-close" onclick="closeModal('modalTambahDokumen')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group"><label class="form-label">Nama Dokumen <span
                            class="required">*</span></label><input type="text" id="dok_nama"
                        class="form-control no-icon" placeholder="Judul dokumen"></div>
                <div class="form-group"><label class="form-label">Deskripsi</label><textarea id="dok_desc"
                        class="form-control no-icon" rows="2" placeholder="Keterangan singkat..."></textarea></div>
                <div class="grid-2">
                    <div class="form-group"><label class="form-label">Kategori <span class="required">*</span></label>
                        <select id="dok_kat" class="form-control form-select no-icon">
                            <option value="KEBIJAKAN">Kebijakan</option>
                            <option value="SOP">SOP</option>
                            <option value="TEMPLATE">Template</option>
                            <option value="PERJANJIAN">Perjanjian (DPA)</option>
                            <option value="LAPORAN">Laporan</option>
                        </select>
                    </div>
                    <div class="form-group"><label class="form-label">Versi</label><input type="text" id="dok_ver"
                            class="form-control no-icon" placeholder="cth: v1.0" value="v1.0"></div>
                </div>
                <div class="grid-2">
                    <div class="form-group"><label class="form-label">Pemilik Dokumen</label><input type="text"
                            id="dok_pemilik" class="form-control no-icon" placeholder="Departemen/Divisi"></div>
                    <div class="form-group"><label class="form-label">Status</label>
                        <select id="dok_status" class="form-control form-select no-icon">
                            <option value="AKTIF">Aktif / Berlaku</option>
                            <option value="RANCANGAN">Rancangan</option>
                            <option value="ARSIP">Arsip</option>
                        </select>
                    </div>
                </div>
                <div class="form-group"><label class="form-label">Referensi Pasal UU PDP</label><input type="text"
                        id="dok_pasal" class="form-control no-icon" placeholder="cth: Pasal 20, Pasal 46"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('modalTambahDokumen')">Batal</button>
                <button class="btn btn-primary" onclick="tambahDokumen()">Simpan Dokumen</button>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>
    <script src="app.js"></script>
    <script>
        let dokFilter = '';
        const defaultDocs = [
            { id: 'DOC-001', nama: 'Kebijakan Privasi PT Atri Pasifik', desc: 'Kebijakan resmi pengelolaan data pribadi pelanggan dan karyawan', kat: 'KEBIJAKAN', ver: 'v2.1', pemilik: 'Legal & Compliance', status: 'AKTIF', tgl: '2025-01-15', pasal: 'Pasal 20, 21', icon: 'ğŸ“œ' },
            { id: 'DOC-002', nama: 'SOP Penanganan DSR', desc: 'Prosedur penanganan permintaan hak subjek data dalam 30 hari', kat: 'SOP', ver: 'v1.3', pemilik: 'DPO', status: 'AKTIF', tgl: '2024-12-01', pasal: 'Pasal 5â€“9', icon: 'ğŸ“‹' },
            { id: 'DOC-003', nama: 'SOP Respons Insiden Kebocoran Data', desc: 'Langkah penanggulangan dan pelaporan insiden keamanan data', kat: 'SOP', ver: 'v1.0', pemilik: 'IT & Legal', status: 'AKTIF', tgl: '2024-11-10', pasal: 'Pasal 46â€“47', icon: 'ğŸš¨' },
            { id: 'DOC-004', nama: 'Template Form Consent', desc: 'Formulir persetujuan standar untuk berbagai keperluan pemrosesan data', kat: 'TEMPLATE', ver: 'v2.0', pemilik: 'Compliance', status: 'AKTIF', tgl: '2025-01-20', pasal: 'Pasal 20', icon: 'ğŸ“' },
            { id: 'DOC-005', nama: 'DPA â€” PT Mitra Logistik', desc: 'Perjanjian perlindungan data dengan vendor logistik selaku prosesor', kat: 'PERJANJIAN', ver: 'v1.0', pemilik: 'Procurement & Legal', status: 'AKTIF', tgl: '2024-10-05', pasal: 'Pasal 53â€“56', icon: 'ğŸ¤' },
            { id: 'DOC-006', nama: 'Template Notifikasi Insiden ke Subjek', desc: 'Template surat pemberitahuan kebocoran data ke subjek terdampak', kat: 'TEMPLATE', ver: 'v1.0', pemilik: 'DPO', status: 'AKTIF', tgl: '2024-11-15', pasal: 'Pasal 46 Ayat 2', icon: 'ğŸ“§' },
            { id: 'DOC-007', nama: 'Laporan Kepatuhan Q4 2024', desc: 'Laporan triwulanan kepatuhan PDP periode Oktoberâ€“Desember 2024', kat: 'LAPORAN', ver: 'v1.0', pemilik: 'DPO', status: 'AKTIF', tgl: '2025-01-31', pasal: '-', icon: 'ğŸ“Š' },
            { id: 'DOC-008', nama: 'Kebijakan Retensi Data', desc: 'Kebijakan periode penyimpanan dan penghapusan data pribadi', kat: 'KEBIJAKAN', ver: 'v1.1', pemilik: 'IT & Legal', status: 'RANCANGAN', tgl: '2025-02-01', pasal: 'Pasal 32', icon: 'ğŸ—“ï¸' },
        ];

        function getDocs() {
            if (!localStorage.getItem('pdp_docs')) localStorage.setItem('pdp_docs', JSON.stringify(defaultDocs));
            return JSON.parse(localStorage.getItem('pdp_docs'));
        }

        const katIcon = { KEBIJAKAN: 'ğŸ“œ', SOP: 'ğŸ“‹', TEMPLATE: 'ğŸ“', PERJANJIAN: 'ğŸ¤', LAPORAN: 'ğŸ“Š', ARSIP: 'ğŸ—„ï¸' };
        const katColor = { KEBIJAKAN: 'badge-primary', SOP: 'badge-info', TEMPLATE: 'badge-success', PERJANJIAN: 'badge-warning', LAPORAN: 'badge-default', LAPORAN: 'badge-default' };

        function renderDocs() {
            const data = getDocs();
            const filtered = dokFilter ? data.filter(d => d.kat === dokFilter) : data;
            document.getElementById('docGrid').innerHTML = filtered.map(d => `
      <div class="doc-card">
        <div style="display:flex; align-items:center; gap:12px;">
          <div style="font-size:28px; line-height:1;">${d.icon || katIcon[d.kat] || 'ğŸ“„'}</div>
          <div style="flex:1;"><span class="badge ${katColor[d.kat] || 'badge-default'} badge-sm">${d.kat}</span></div>
          ${statusBadge(d.status)}
        </div>
        <h4>${d.nama}</h4>
        <p>${d.desc}</p>
        <div class="doc-meta">
          <div>
            <span class="td-meta">ğŸ“… ${formatDate(d.tgl)}</span>
            <span class="td-meta" style="margin-left:8px;">ğŸ·ï¸ ${d.ver}</span>
          </div>
          <span class="td-meta">${d.pemilik}</span>
        </div>
        ${d.pasal && d.pasal !== '-' ? `<div style="font-size:11px; color:var(--info); background:var(--info-bg); padding:5px 10px; border-radius:6px;">ğŸ›ï¸ ${d.pasal}</div>` : ''}
        <div style="display:flex; gap:8px; margin-top:4px;">
          <button class="btn btn-outline btn-sm" style="flex:1;" onclick="showToast('Unduh','Fitur unduh akan aktif pada versi produksi', 'info')">ğŸ“¥ Unduh</button>
          <button class="btn btn-primary btn-sm" style="flex:1;" onclick="showToast('Lihat','Pembuka dokumen akan aktif pada versi produksi', 'info')">ğŸ‘ï¸ Lihat</button>
        </div>
      </div>
    `).join('') || '<div style="grid-column:span 3;"><div class="empty-state"><div class="empty-icon">ğŸ“„</div><h4>Belum ada dokumen</h4></div></div>';
        }

        function filterDokumen(kat, btn) {
            dokFilter = kat;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderDocs();
        }

        function tambahDokumen() {
            const nama = document.getElementById('dok_nama').value.trim();
            if (!nama) { showToast('Form Tidak Lengkap', 'Isi nama dokumen', 'error'); return; }
            const data = getDocs();
            const d = {
                id: generateId('DOC'), nama, desc: document.getElementById('dok_desc').value || '-',
                kat: document.getElementById('dok_kat').value,
                ver: document.getElementById('dok_ver').value || 'v1.0',
                pemilik: document.getElementById('dok_pemilik').value || 'DPO',
                status: document.getElementById('dok_status').value,
                pasal: document.getElementById('dok_pasal').value || '-',
                tgl: new Date().toISOString().split('T')[0],
                icon: 'ğŸ“„'
            };
            data.unshift(d);
            localStorage.setItem('pdp_docs', JSON.stringify(data));
            addAuditLog('DOC_ADD', `Dokumen baru ${d.id}: ${nama} (${d.kat})`);
            closeModal('modalTambahDokumen');
            renderDocs();
            showToast('Dokumen Disimpan', `${d.id} berhasil ditambahkan ke repositori`, 'success');
        }

        document.addEventListener('DOMContentLoaded', () => { requireAuth(); renderDocs(); });
    </script>
</body>

</html>